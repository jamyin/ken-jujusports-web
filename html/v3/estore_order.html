<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<link rel="icon" type="image/gif" href="static/img/favicon.ico">
		<title>聚运动</title>
		<script src="static/js/jquery-2.1.3.min.js"></script>
		<script src="static/js/common.js"></script>
		<link href="static/css/style.css" rel="stylesheet" />
		<link href="static/css/eshop-detail.css" rel="stylesheet" />
	</head>

	<body>
		<script src="static/js/header.js"></script>
		<div class="store_topbar">
			<span>订单确认信息</span>
		</div>
		<div class="wrapper">
			<div class="add-address">
				<h2>新增地址</h2>
				<div class="must-fill">
					<ul class="fill-ul">
						<li>
							<label><span class="must">*</span>收货人姓名</label>
							<input  type="text" id="" value="" />
						</li>
						<li>
							<label><span class="must">*</span>省份</label>
							<select class="area province">
								<option selected>上海</option>
								<option>北京</option>
							</select>
							<select class="area city">
								<option selected>上海市</option>
								<option>北京市</option>
							</select>
							<select class="area county">
								<option selected>徐汇区</option>
								<option>奉贤区</option>
							</select>
						</li>
						<li>
							<label><span class="must">*</span>详细地址</label>
							<input  id="" type="text" name="" value="" >
						</li>
						<li>
							<label><span class="must">*</span>手机号码</label>
							<input  id="" type="text" name="" value="">
						</li>
						<li>
							<label>邮箱地址</label>
							<input id="" type="text" name="" value="">
						</li>
						<li>
							<label>邮政编码</label>
							<input  id="" type="text" name="" value="">
						</li>
						<li>
							<label>地址别名</label>
							<input  id="" type="text" name="" value="">
						</li>
						<li>
							<label></label>
							<input class="setDefault" type="checkbox" name="" value="" id="t1">
							<label class="setDefault"for="t1" >设为默认地址</label>
						</li>
						<li>
							<label></label>
							<a class="bt save">保存</a>
							<a class="bt cancle">取消</a>
						</li>
					</ul>
				</div>
			</div>
		</div>
		
	<div class="cart_box">
		<h4>商品详情</h4>
		<div class="bar">
			<i tag="none"></i>
			<span class="choose">全选</span>
			<span class="goodsname">商品</span>
			<span class="price">单价</span>
			<span class="amount">数量</span>
			<span class="total_price">小计</span>
			<span class="stock"><select><option>上海</option><option>上海</option><option>上海</option><option>上海</option><option>上海</option></select></span>
			<span class="action">操作</span>
		</div>
		<ul>
			<li class="no-sel">
				 <i></i>
				 <a href="###"><img class="pic" src="static/img/goods.png" border="0">
				<span class="goodsname">NIKE 国际米兰赛季主场球衣赛季主场球衣赛季主场球衣赛季主场球衣</span></a>
				<span class="price">￥65.00</span>				
				<span class="amount"><a class="minus" href="###">-</a><input class="amt" sin_price="65.00" data_max="14" value="10"><a class="plus" href="###">+</a></span>
				<span class="total_price">￥399.00</span>
				<span class="stock">有货</span>
				<span class="action"><a href="###">删除</a></span>
			</li>			
			<li class="no-sel">
				 <i></i>
				 <a href="###"><img class="pic" src="static/img/goods.png" border="0">
				<span class="goodsname">NIKE 国际米兰赛季主场球衣赛季主场球衣赛季主场球衣赛季主场球衣</span></a>
				<span class="price">￥65.00</span>				
				<span class="amount"><a class="minus" href="###">-</a><input class="amt" sin_price="65.00" data_max="14" value="10"><a class="plus" href="###">+</a></span>
				<span class="total_price">￥399.00</span>
				<span class="stock">有货</span>
				<span class="action"><a href="###">删除</a></span>
			</li>			
			<li class="no-sel">
				 <i></i>
				 <a href="###"><img class="pic" src="static/img/goods.png" border="0">
				<span class="goodsname">NIKE 国际米兰赛季主场球衣赛季主场球衣赛季主场球衣赛季主场球衣</span></a>
				<span class="price">￥65.00</span>				
				<span class="amount"><a class="minus" href="###">-</a><input class="amt" sin_price="65.00" data_max="14" value="10"><a class="plus" href="###">+</a></span>
				<span class="total_price">￥399.00</span>
				<span class="stock">有货</span>
				<span class="action"><a href="###">删除</a></span>
			</li>			
			<li class="no-sel">
				 <i></i>
				 <a href="###"><img class="pic" src="static/img/goods.png" border="0">
				<span class="goodsname">NIKE 国际米兰赛季主场球衣赛季主场球衣赛季主场球衣赛季主场球衣</span></a>
				<span class="price">￥65.00</span>				
				<span class="amount"><a class="minus" href="###">-</a><input class="amt" sin_price="65.00" data_max="14" value="10"><a class="plus" href="###">+</a></span>
				<span class="total_price">￥399.00</span>
				<span class="stock">有货</span>
				<span class="action"><a href="###">删除</a></span>
			</li>			
		</ul>
		<div class="b_bar"><a class="del_all" href="###">删除购车商品</a><a href="###">继续购物</a></div>
		<div class="total_box">共计（不含运费）：<span>￥0</span></div>
		<div class="submit"><a href="###">确认结算</a></div>
	</div>

		<script src="static/js/footer.js"></script>
		<script>
	$(function(){		
		//导航标记
		nav_mark('SportStore')
		
		var del = $('.cart_box ul li .action a')
		var del_all = $('.del_all')
		var choose = $('.cart_box ul li i')
		var choose_all = $('.cart_box .bar i')
		
		del.on('click', function(){
			$(this).closest('li').remove()
			price_all()
		})
		choose.on('click', function(){
			var _t = $(this).closest('li').attr('class')
			if(_t=='no-sel'){
				$(this).addClass('cur')
				$(this).closest('li').attr('class','seled')
			}else{
				$(this).removeClass('cur')
				$(this).closest('li').attr('class','no-sel')
			}
		    mark_all()
			price_all()
		})
		choose_all.on('click', function(){
			var _t  = $(this).attr('tag')
			if(_t=='none'){
				$(this).addClass('cur')
				$(this).attr('tag','all')
				$('.cart_box ul li i').addClass('cur')
				$('.cart_box ul li').attr('class','seled')
			}else{
				$(this).removeClass('cur')
				$(this).attr('tag','none')
				$('.cart_box ul li i').removeClass('cur')
				$('.cart_box ul li').attr('class','no-sel')
			}
			price_all()
		})
		del_all.on('click', function(){
			$('.cart_box ul li.seled').remove()
			mark_all()
			price_all()
		})
		
		$(".minus").on("click", function() {
			var amt_field = $(this).parent().find('.amt')
			if(parseInt(amt_field.val()) <= 1){
				return
			}else{
				amt_field.val(parseInt(amt_field.val()) - 1);
			}
			price_all()
		})
		$(".plus").on("click", function() {
			var amt_field = $(this).parent().find('.amt')
			if(parseInt(amt_field.val()) >= parseInt(amt_field.attr('data_max'))){
				return
			}else{
				amt_field.val(parseInt(amt_field.val()) + 1);
			}
			price_all()
		})
		$(".amt").on("keyup", function() {
					var val = $(this).val(),max = parseInt($(this).attr("max"));
					if (val.length == 0) {
						return;
					}
					val = isNaN(parseInt(val, 10)) ? 1 : parseInt(val, 10);
					val = val < 1 ? 1 : val;
					val = val >= max ? max : val;
					$(this).val(val);
				}).on("blur", function() {
					var val = $(this).val(),max = parseInt($(this).attr("max"));
					if (val.length == 0) {
						$(this).val(1);
					}
					val = isNaN(parseInt(val, 10)) ? 1 : parseInt(val, 10);
					val = val < 1 ? 1 : val;
					val = val >= max ? max : val;
					$(this).val(val);
					price_all()
				});

	})
	function mark_all(){
		 //判断选择
		var _curNum = $('.cart_box ul li.seled').length
		var _totalNum = $('.cart_box ul li').length
		if(_curNum == _totalNum){
			$('.cart_box .bar i').addClass('cur')
			$('.cart_box .bar i').attr('tag','all')
		}else if(_curNum < _totalNum){
			$('.cart_box .bar i').removeClass('cur')
			$('.cart_box .bar i').attr('tag','none')
		}
		if( _totalNum <= 0){
			$('.cart_box .bar i').removeClass('cur')
			$('.cart_box .bar i').attr('tag','none')
		}
	}
	function price_all(){
	//计算总价
		var _totalPrice = 0;
		for(i=0;i<$('.cart_box ul li.seled .amt').length;i++){
			_totalPrice = _totalPrice + parseInt($('.cart_box ul li.seled .amt').eq(i).val())*parseInt($('.cart_box ul li.seled .amt').eq(i).attr('sin_price'))
		}
		$('.total_box span').text('￥' + _totalPrice)
	}
		</script>
	</body>

</html>