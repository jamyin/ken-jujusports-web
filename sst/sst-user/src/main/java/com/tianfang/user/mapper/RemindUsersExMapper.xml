<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianfang.user.mapper.RemindUsersExMapper">

  <resultMap id="remindPojoMap" type="com.tianfang.user.pojo.Remind" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 15 17:01:04 CST 2016.
    -->
    <id column="id" property="id" jdbcType="VARCHAR" />
    <result column="to_user_id" property="toUserId" jdbcType="VARCHAR" />
    <result column="to_user_name" property="toUserName" jdbcType="VARCHAR" />
    <result column="type" property="type" jdbcType="INTEGER" />
    <result column="send_time" property="sendTime" jdbcType="TIMESTAMP" />
    <result column="attachment" property="attachment" jdbcType="VARCHAR" />
    <result column="text" property="text" jdbcType="VARCHAR" />
    <result column="voice" property="voice" jdbcType="VARCHAR" />
    <result column="user_id" property="userId" jdbcType="VARCHAR" />
    <result column="user_name" property="userName" jdbcType="VARCHAR" />
    <result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
    <result column="last_update_time" property="lastUpdateTime" jdbcType="TIMESTAMP" />
    <result column="stat" property="stat" jdbcType="INTEGER" />
  </resultMap>

	 <insert id="insertList" parameterType="java.util.List">  
      INSERT INTO sst_remind_users (id, remind_id, user_id, readstat,
	               create_time, last_update_time, stat)
      VALUES 
     <foreach collection="list" item="item" index="index" separator="," >  
        (#{item.id},#{item.remindId},#{item.userId},#{item.readstat},
         #{item.createTime},#{item.lastUpdateTime},#{item.stat})  
    </foreach> 
  </insert>
  
  <select id="queryRemindList" resultMap="remindPojoMap" parameterType="java.lang.String">
		SELECT * FROM `sst_remind` a WHERE a.id IN (
			SELECT b.`remind_id` FROM `sst_remind_users` b WHERE b.`user_id` = #{userId}
		) limit #{page.startNum}, #{page.pageSize} 
		;
  </select>
  
  <select id="countRemindList" resultType="java.lang.Integer" parameterType="java.lang.String">
  		SELECT count(a.id) FROM `sst_remind` a WHERE a.id IN (
			SELECT b.`remind_id` FROM `sst_remind_users` b WHERE b.`user_id` = #{userId}
		);
  </select>
</mapper> 
