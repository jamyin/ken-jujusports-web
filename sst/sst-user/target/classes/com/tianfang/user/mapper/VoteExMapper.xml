<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.tianfang.user.mapper.VoteExMapper" >
	<select id="findVoteExById" resultType="com.tianfang.user.dto.VoteExDto" parameterType="string">
	 	SELECT d.id AS voteId, d.title AS title, d.option_num AS optionNum, d.end_time AS endTime, d.is_anonymous AS isAnonymous, d.user_id AS userId, d.user_name AS userName,
		a.id AS optionId, a.text AS optionText, c.id AS optionUserId, c.nick_name AS optionNickName
		FROM sst_vote_option AS a
		LEFT JOIN sst_vote_user_option AS b ON a.id = b.option_id AND b.stat = 1
		LEFT JOIN sst_user AS c ON c.id = b.user_id AND c.stat = 1
		JOIN sst_vote AS d ON a.vote_id = d.id
		WHERE d.id = #{id} AND d.stat = 1 AND a.stat =1 ORDER BY a.create_time DESC
	</select>
</mapper>